/*! updated; 07-19-2016 12:49 PM */

window.FOX_Plugins=window.FOX_Plugins||{};var EventMessageHandler=FOX_Plugins.EventMessageHandler=function(){var CONST={};CONST.stringify=function(){var ver=!1;if(navigator&&"Microsoft Internet Explorer"===navigator.appName){var ua=navigator.userAgent,re=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");null!=re.exec(ua)&&(ver=parseFloat(RegExp.$1)),ver&&9>=ver&&(ver=!0)}return ver}();var App=function(config){var v=this.__v={};v._handlers={},this.init()};App.prototype.init=function(){var vars=this.__v;vars._messageHandler=function(event){var message=event.data,hasErr=!1;if(CONST.stringify){if(!window.JSON)return log("[EventMessageHandler.send] Requires JSON"),!1;try{message=JSON.parse(message)}catch(err){log("[EventMessageHandler.send] error:"),log(err);var hasErr=!0}}if(!hasErr){log("[EventMessageHandler.receive]",message);var type=message&&message.type?message.type:!1,data=message&&message.data?message.data:!1;type&&data&&vars._handlers[type]&&"function"==typeof vars._handlers[type]&&vars._handlers[type](data)}};try{window.addEventListener("message",vars._messageHandler,!1)}catch(error){window.attachEvent("onmessage",vars._messageHandler)}this.init=function(){}},App.prototype.addHandler=function(type,callback){var self=this,vars=self.__v,prefix=vars.config&&"string"==typeof vars.config.prefix?vars.config.prefix:"";return"string"!=typeof type?!1:(type=prefix+type,void(vars._handlers[type]=callback))},App.prototype.sendMessage=function(element,type,data){var self=this,vars=self.__v,prefix=vars.config&&"string"==typeof vars.config.prefix?vars.config.prefix:"";if("string"!=typeof type)return!1;type=prefix+type;var info={type:type,data:data};if(CONST.stringify){if(!window.JSON)return log("[EventMessageHandler.send] Requires JSON"),!1;info=JSON.stringify(info)}if(element&&"string"==typeof element&&"parent"===element)window.parent.postMessage(info,"*"),log("[EventMessageHandler.send]",info);else if(element&&"string"==typeof element&&"self"===element)window.postMessage(info,"*");else if(element&&element.contentWindow)try{element.contentWindow.postMessage(info,"*"),log("[EventMessageHandler.send]",info)}catch(err){}};var log=function(){var loggerON=window.location.search.indexOf("_log=y")>-1?!0:!1;if(loggerON&&window.console)try{return console.log.apply(console,arguments)}catch(err){console.log(arguments)}};return App}();!function(Modulr){return Modulr?void Modulr.define("FOX_Plugins:EventMessageHandler",function(){return window.FOX_Plugins.EventMessageHandler}):!1}(window.Modulr);